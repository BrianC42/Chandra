function UpdateYahooFinanceData() {
  var spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
  var x, y
  var headers, header
  var symbol_col, recommendation, tgtLow, tgtMedian, tgtMean, tgtHigh, profitMargin
  var symbols
  var dataValues
  var txtRange
  var start
  var YahooData = []

  yahoo_finance_sheet = spreadsheet.setActiveSheet(spreadsheet.getSheetByName("Yahoo Finance"))
  Logger.log("Yahoo Finance set active")
  
  rows = 500
  cols = 18
  firstCol = "A"
  lastCol = "R"
  startRow = "23"

  colHeaders = yahoo_finance_sheet.getRange(firstCol + "1" + ":" + lastCol + "1")
  txtSymbolsRange = firstCol + startRow + ":" + firstCol + rows
  symbolsRange = yahoo_finance_sheet.getRange(txtSymbolsRange)
  txtDataRange = firstCol + startRow + ":" + lastCol + rows
  dataRange = yahoo_finance_sheet.getRange(txtDataRange)

  spreadsheet.setActiveRange(colHeaders)
  headers = colHeaders.getValues()
  Logger.log("headers count: " + headers[0].length + " " + headers[0])
  x = 0
  while (x < headers[0].length) {
    Logger.log("Header: " + headers[0][x])
    if (headers[0][x] == "Symbol") {
      symbol_col = x
    }
    if (headers[0][x] == "Recommendation") {
      recommendation = x
    }
    if (headers[0][x] == "Low") {
      tgtLow = x
    }
    if (headers[0][x] == "Median") {
      tgtMedian = x
    }
    if (headers[0][x] == "Mean") {
      tgtMean = x
    }
    if (headers[0][x] == "High") {
      tgtHigh = x
    }
    if (headers[0][x] == "Profit Margins") {
      profitMargin = x
    }
    x += 1
  }
  
  spreadsheet.setActiveRange(symbolsRange)
  symbols = symbolsRange.getValues()
  Logger.log("symbols " + symbols)
  dataValues = dataRange.getValues()
  y = 0
  start = new Date();
  while (y < symbols.length) {
    if (symbols[y][0] == "") {
      break
    }

    if (isTimeUp_(start)) {
      Logger.log("Time limit reached - restart at " + symbols[y][0]);
      break
    }

    dataValues[y][recommendation] = ""
    dataValues[y][tgtLow] = 0.0
    dataValues[y][tgtMedian] = 0.0
    dataValues[y][tgtMean] = 0.0
    dataValues[y][tgtHigh] = 0.0
    dataValues[y][profitMargin] = 0.0

    YahooData = getSingleAnalysis(symbols[y][0])

    dataValues[y][recommendation] = YahooData[10]
    dataValues[y][tgtLow] = YahooData[11]
    dataValues[y][tgtMedian] = YahooData[12]
    dataValues[y][tgtMean] = YahooData[13]
    dataValues[y][tgtHigh] = YahooData[14]
    dataValues[y][profitMargin] = YahooData[15]

    Logger.log("Symbol: " + symbols[y][0])
    y += 1
  }
  dataValues = dataRange.setValues(dataValues)
}
